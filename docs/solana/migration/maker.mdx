---
id: maker
hide_title: true
sidebar_label: Maker Migration
slug: /solana/migration/maker
hide_table_of_contents: true
---

import useBaseUrl from '@docusaurus/useBaseUrl'

:::warning ðŸš§ This document is a work in progress. ðŸš§

The documentation on Solana and the upcoming Migration is under development and subject to change.

:::

# Maker Migration

# Maker App 2.0 Upgrade Guide

## Update and add new dependencies

```json
"@helium/address": "^4.8.1",
"@helium/currency-utils": "^0.0.26",
"@helium/react-native-sdk": "2.0.0",
"@helium/wallet-link": "^4.8.3",
"@metaplex-foundation/mpl-bubblegum": "^0.6.2",
"@pythnetwork/client": "^2.11.0",
"@solana/web3.js": "^1.73.0",
"axios-retry": "^3.3.1",
"cipher-base": "^1.0.4",
"react-native-quick-crypto": "^0.5.0",
"stream": "^0.0.2"
```

## Update Babel Config to alias crypto library

```jsx
// babel.config.js
function getAliasesFromTsConfig() {
  const tsConfig = require('./tsconfig.json')
  const paths = tsConfig.compilerOptions.paths
  let alias = {}
  Object.keys(paths).forEach((key) => {
    alias[key] = `./${paths[key][0]}`
  })

  return alias
}

const baseConfig = {
  presets: ['module:metro-react-native-babel-preset'],
  plugins: [
    [
      'module-resolver',
      {
        alias: {
          ...getAliasesFromTsConfig(),
          crypto: 'react-native-quick-crypto', // <--- This
        },
        extensions: ['.ios.js', '.android.js', '.js', '.ts', '.tsx', '.json'],
        root: ['./src'],
      },
    ],
  ],
}

module.exports = (api) => {
  api.cache(true)

  return {
    ...baseConfig,
    plugins: [...baseConfig.plugins, 'react-native-reanimated/plugin'],
  }
}
```

## Update App Providers

```tsx
// TODO:
```

---

# Onboarding a hotspot

When onboarding a hotspot you must specify which `hotspotTypes` it supports (eg `iot` , `mobile`)

You can optionally set `elevation`, `gain`, `lat`, and `lng` to avoid having to create a second
transaction

### Create Onboard Transactions

`src/features/hotspots/setup/HotspotSetupConfirmLocationScreen.tsx`

```tsx
const { getOnboardingRecord, getOnboardTransactions } = useOnboarding()

let hotspotTypes = [] as HotspotType[]
const onboardingRecord = await getOnboardingRecord(params.hotspotAddress)
/*
   TODO: Determine which network types this hotspot supports
   Could possibly use your maker address
*/
if (Config.MAKER_ADDRESS_5G === onboardingRecord?.maker.address) {
  hotspotTypes = ['iot', 'mobile']
} else {
  hotspotTypes = ['iot']
}

const onboardData = await getOnboardTransactions({
  txn: params.addGatewayTxn,
  hotspotAddress: params.hotspotAddress,
  hotspotTypes,
  elevation,
  decimalGain: gain,
  lat,
  lng,
})

// pre-solana this txn will exist
setAddGatewayTxn(onboardData.addGatewayTxn)

// post-solana these txn(s) will exist
setSolanaTransactions(onboardData.solanaTransactions)
```

## Linking to Helium Wallet App for signing

You must add `solanaTransactions` to the signature request

`src/features/hotspots/setup/HotspotTxnsProgressScreen.tsx`

```tsx
const updateParams = {
  token,
  platform: Platform.OS,
  addGatewayTxn,
  assertLocationTxn,
  transferHotspotTxn,
  solanaTransactions, // <---- !important!
} as SignHotspotRequest
const url = createUpdateHotspotUrl(updateParams)
Linking.openURL(url)
```

## Submit signed transaction(s)

```tsx
// src/features/hotspots/setup/HotspotTxnsSubmitScreen.tsx
const { submitTransactions } = useOnboarding()
const { pendingAssertTxn, pendingGatewayTxn, pendingTransferTxn, solanaTxnIds } =
  await submitTransactions({
    addGatewayTxn: params.gatewayTxn,
    assertLocationTxn: params.assertTxn,
    hotspotAddress: params.gatewayAddress,
    solanaTransactions,
    transferHotspotTxn: params.transferTxn,
  })
```

---

# Updating a hotspot

TODO: Show how this is done

---

# Transferring a hotspot

TODO: Show how this is done

---

# Fetching Hotspots

TODO: Show how this is done

# Update wallet link

Helium Hotspot App is deprecated, you should link your app to the new black wallet app

TODO: Show how this is done

---

## Full diff can be found here

[Feature/solana by matthewcarlreetz Â· Pull Request #52 Â· helium/maker-starter-app](https://github.com/helium/maker-starter-app/pull/52/files?diff=split&w=1)

## Data Credits and Sol for Onboarding

// TODO: We need to create an easy way for makers to get sol and data credits into their accounts
